<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>个人博客</title>
    <meta name="description" content="This is a blog example built by VuePress">
    
    
    <link rel="preload" href="/vuepressblog/assets/css/0.styles.782d1301.css" as="style"><link rel="preload" href="/vuepressblog/assets/js/app.34ed5399.js" as="script"><link rel="preload" href="/vuepressblog/assets/js/4.b4e60a56.js" as="script"><link rel="preload" href="/vuepressblog/assets/js/5.437ceeb3.js" as="script"><link rel="preload" href="/vuepressblog/assets/js/37.1d249a16.js" as="script"><link rel="prefetch" href="/vuepressblog/assets/js/1.16f713a9.js"><link rel="prefetch" href="/vuepressblog/assets/js/10.940970eb.js"><link rel="prefetch" href="/vuepressblog/assets/js/11.b539ea55.js"><link rel="prefetch" href="/vuepressblog/assets/js/12.0cfe72b3.js"><link rel="prefetch" href="/vuepressblog/assets/js/13.e03e06a0.js"><link rel="prefetch" href="/vuepressblog/assets/js/14.d51b12fd.js"><link rel="prefetch" href="/vuepressblog/assets/js/15.2f6bd966.js"><link rel="prefetch" href="/vuepressblog/assets/js/16.c821a87b.js"><link rel="prefetch" href="/vuepressblog/assets/js/17.1d39a121.js"><link rel="prefetch" href="/vuepressblog/assets/js/18.b7328a1a.js"><link rel="prefetch" href="/vuepressblog/assets/js/19.def8f7d1.js"><link rel="prefetch" href="/vuepressblog/assets/js/20.af7b2e69.js"><link rel="prefetch" href="/vuepressblog/assets/js/21.baeb5c5c.js"><link rel="prefetch" href="/vuepressblog/assets/js/22.e3ea399c.js"><link rel="prefetch" href="/vuepressblog/assets/js/23.eb03037a.js"><link rel="prefetch" href="/vuepressblog/assets/js/24.b2b8255c.js"><link rel="prefetch" href="/vuepressblog/assets/js/25.d648b024.js"><link rel="prefetch" href="/vuepressblog/assets/js/26.0e3152ba.js"><link rel="prefetch" href="/vuepressblog/assets/js/27.deaabd4e.js"><link rel="prefetch" href="/vuepressblog/assets/js/28.ed1f0893.js"><link rel="prefetch" href="/vuepressblog/assets/js/29.4669c16f.js"><link rel="prefetch" href="/vuepressblog/assets/js/30.8b26e6d0.js"><link rel="prefetch" href="/vuepressblog/assets/js/31.116a34db.js"><link rel="prefetch" href="/vuepressblog/assets/js/32.93e9dbf1.js"><link rel="prefetch" href="/vuepressblog/assets/js/33.14d71321.js"><link rel="prefetch" href="/vuepressblog/assets/js/34.d895ea94.js"><link rel="prefetch" href="/vuepressblog/assets/js/35.b73195c8.js"><link rel="prefetch" href="/vuepressblog/assets/js/36.d6a475e0.js"><link rel="prefetch" href="/vuepressblog/assets/js/38.5bfebe3a.js"><link rel="prefetch" href="/vuepressblog/assets/js/39.98d3abdc.js"><link rel="prefetch" href="/vuepressblog/assets/js/40.77362dd9.js"><link rel="prefetch" href="/vuepressblog/assets/js/41.9714a402.js"><link rel="prefetch" href="/vuepressblog/assets/js/42.5c80b8f2.js"><link rel="prefetch" href="/vuepressblog/assets/js/43.8d567d37.js"><link rel="prefetch" href="/vuepressblog/assets/js/44.d6b5729c.js"><link rel="prefetch" href="/vuepressblog/assets/js/45.d36f522e.js"><link rel="prefetch" href="/vuepressblog/assets/js/46.753217d8.js"><link rel="prefetch" href="/vuepressblog/assets/js/47.5e317be5.js"><link rel="prefetch" href="/vuepressblog/assets/js/48.633080c8.js"><link rel="prefetch" href="/vuepressblog/assets/js/49.59540068.js"><link rel="prefetch" href="/vuepressblog/assets/js/50.c6bac4b3.js"><link rel="prefetch" href="/vuepressblog/assets/js/51.5e9507f2.js"><link rel="prefetch" href="/vuepressblog/assets/js/52.f1b4f07f.js"><link rel="prefetch" href="/vuepressblog/assets/js/53.79627a04.js"><link rel="prefetch" href="/vuepressblog/assets/js/54.7321bb5a.js"><link rel="prefetch" href="/vuepressblog/assets/js/55.81f96300.js"><link rel="prefetch" href="/vuepressblog/assets/js/56.52bdbaf9.js"><link rel="prefetch" href="/vuepressblog/assets/js/57.46b90993.js"><link rel="prefetch" href="/vuepressblog/assets/js/58.bc612a04.js"><link rel="prefetch" href="/vuepressblog/assets/js/59.849c15d9.js"><link rel="prefetch" href="/vuepressblog/assets/js/6.2eb981f1.js"><link rel="prefetch" href="/vuepressblog/assets/js/60.3e5b9b12.js"><link rel="prefetch" href="/vuepressblog/assets/js/61.0d44f6fc.js"><link rel="prefetch" href="/vuepressblog/assets/js/62.04363bf9.js"><link rel="prefetch" href="/vuepressblog/assets/js/63.cca8ee33.js"><link rel="prefetch" href="/vuepressblog/assets/js/64.96e45510.js"><link rel="prefetch" href="/vuepressblog/assets/js/65.63ac4374.js"><link rel="prefetch" href="/vuepressblog/assets/js/66.7ec49135.js"><link rel="prefetch" href="/vuepressblog/assets/js/67.0a87e1f1.js"><link rel="prefetch" href="/vuepressblog/assets/js/68.2c53fc3a.js"><link rel="prefetch" href="/vuepressblog/assets/js/69.ec436606.js"><link rel="prefetch" href="/vuepressblog/assets/js/7.5286a1d0.js"><link rel="prefetch" href="/vuepressblog/assets/js/70.32df5cd4.js"><link rel="prefetch" href="/vuepressblog/assets/js/71.2329802d.js"><link rel="prefetch" href="/vuepressblog/assets/js/72.80b3ff8f.js"><link rel="prefetch" href="/vuepressblog/assets/js/8.fec3f887.js"><link rel="prefetch" href="/vuepressblog/assets/js/9.addd09b9.js"><link rel="prefetch" href="/vuepressblog/assets/js/vuejs-paginate.47274855.js">
    <link rel="stylesheet" href="/vuepressblog/assets/css/0.styles.782d1301.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuperess-theme-blog__global-layout"><section id="header-wrapper"><header id="header"><div class="header-wrapper"><div class="title"><a href="/vuepressblog/" class="nav-link home-link">个人博客
        </a></div> <div class="header-right-wrap"><ul class="nav"><li class="nav-item"><a href="/vuepressblog/" class="nav-link">Blog</a></li><li class="nav-item"><a href="/vuepressblog/tag/" class="nav-link">Tags</a></li></ul> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div></div></header></section> <div id="mobile-header"><div class="mobile-header-bar"><div class="mobile-header-title"><a href="/vuepressblog/" class="nav-link mobile-home-link">个人博客
      </a> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></div> <div class="mobile-menu-wrapper"><hr class="menu-divider"> <ul class="mobile-nav"><li class="mobile-nav-item"><a href="/vuepressblog/" class="nav-link">Blog</a></li><li class="mobile-nav-item"><a href="/vuepressblog/tag/" class="nav-link">Tags</a></li></ul></div></div></div> <div class="content-wrapper"><div id="vuperess-theme-blog__post-layout"><div class="vuepress-blog-theme-content"><div class="content__default"><div align="center"><a href="http://typeorm.io/"><img src="https://github.com/typeorm/typeorm/raw/master/resources/logo_big.png" width="492" height="228"></a> <br> <br> <a href="https://app.circleci.com/pipelines/github/typeorm/typeorm"><img src="https://circleci.com/gh/typeorm/typeorm/tree/master.svg?style=shield"></a> <a href="https://badge.fury.io/js/typeorm"><img src="https://badge.fury.io/js/typeorm.svg"></a> <a href="https://david-dm.org/typeorm/typeorm"><img src="https://david-dm.org/typeorm/typeorm.svg"></a> <a href="https://gitter.im/typeorm/typeorm?utm_source=badge&amp;utm_medium=badge&amp;utm_campaign=pr-badge&amp;utm_content=badge"><img src="https://badges.gitter.im/typeorm/typeorm.svg"></a> <br> <br></div> <p>TypeORM 是一个<a href="https://en.wikipedia.org/wiki/Object-relational_mapping" target="_blank" rel="noopener noreferrer">ORM<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>框架，它可以运行在 NodeJS、Browser、Cordova、PhoneGap、Ionic、React Native、Expo 和 Electron 平台上，可以与 TypeScript 和 JavaScript (ES5,ES6,ES7,ES8)一起使用。 它的目标是始终支持最新的 JavaScript 特性并提供额外的特性以帮助你开发任何使用数据库的（不管是只有几张表的小型应用还是拥有多数据库的大型企业应用）应用程序。</p> <p>不同于现有的所有其他 JavaScript ORM 框架，TypeORM 支持 Active Record](active-record-data-mapper.md#what-is-the-active-record-pattern) 和 <a href="/vuepressblog/_posts/typeromdoc/active-record-data-mapper.html#what-is-the-data-mapper-pattern">Data Mapper</a> 模式，这意味着你可以以最高效的方式编写高质量的、松耦合的、可扩展的、可维护的应用程序。</p> <p>TypeORM 参考了很多其他优秀 ORM 的实现, 比如 <a href="http://hibernate.org/orm/" target="_blank" rel="noopener noreferrer">Hibernate<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, <a href="http://www.doctrine-project.org/" target="_blank" rel="noopener noreferrer">Doctrine<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 和 <a href="https://www.asp.net/entity-framework" target="_blank" rel="noopener noreferrer">Entity Framework<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <p>TypeORM 的一些特性:</p> <ul><li>支持 <a href="/vuepressblog/_posts/typeromdoc/active-record-data-mapper.html#what-is-the-data-mapper-pattern">DataMapper</a> 和 <a href="/vuepressblog/_posts/typeromdoc/active-record-data-mapper.html#what-is-the-active-record-pattern">ActiveRecord</a> (随你选择)</li> <li>实体和列</li> <li>数据库特性列类型</li> <li>实体管理</li> <li>存储库和自定义存储库</li> <li>清晰的对象关系模型</li> <li>关联（关系）</li> <li>贪婪和延迟关系</li> <li>单向的，双向的和自引用的关系</li> <li>支持多重继承模式</li> <li>级联</li> <li>索引</li> <li>事务</li> <li>迁移和自动迁移</li> <li>连接池</li> <li>主从复制</li> <li>使用多个数据库连接</li> <li>使用多个数据库类型</li> <li>跨数据库和跨模式查询</li> <li>优雅的语法，灵活而强大的 QueryBuilder</li> <li>左联接和内联接</li> <li>使用联查查询的适当分页</li> <li>查询缓存</li> <li>原始结果流</li> <li>日志</li> <li>监听者和订阅者（钩子）</li> <li>支持闭包表模式</li> <li>在模型或者分离的配置文件中声明模式</li> <li>json / xml / yml / env 格式的连接配置</li> <li>支持 MySQL / MariaDB / Postgres / SQLite / Microsoft SQL Server / Oracle / sql.js</li> <li>支持 MongoDB NoSQL 数据库</li> <li>可在 NodeJS / 浏览器 / Ionic / Cordova / React Native / Expo / Electron 平台上使用</li> <li>支持 TypeScript 和 JavaScript</li> <li>生成高性能、灵活、清晰和可维护的代码</li> <li>遵循所有可能的最佳实践</li> <li>命令行工具</li></ul> <p>还有更多...</p> <p>通过使用 <code>TypeORM</code> 你的 <code>models</code> 看起来像这样:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Entity<span class="token punctuation">,</span> PrimaryGeneratedColumn<span class="token punctuation">,</span> Column <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;typeorm&quot;</span><span class="token punctuation">;</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
  @<span class="token function">PrimaryGeneratedColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  firstName<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  lastName<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  age<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>逻辑操作就像是这样:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
user<span class="token punctuation">.</span>firstName <span class="token operator">=</span> <span class="token string">&quot;Timber&quot;</span><span class="token punctuation">;</span>
user<span class="token punctuation">.</span>lastName <span class="token operator">=</span> <span class="token string">&quot;Saw&quot;</span><span class="token punctuation">;</span>
user<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">25</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> repository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> allUsers <span class="token operator">=</span> <span class="token keyword">await</span> repository<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> firstUser <span class="token operator">=</span> <span class="token keyword">await</span> repository<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// find by id</span>
<span class="token keyword">const</span> timber <span class="token operator">=</span> <span class="token keyword">await</span> repository<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span> firstName<span class="token punctuation">:</span> <span class="token string">&quot;Timber&quot;</span><span class="token punctuation">,</span> lastName<span class="token punctuation">:</span> <span class="token string">&quot;Saw&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">await</span> repository<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>timber<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>或者，如果你更喜欢使用<code>ActiveRecord</code>实现，也可以这样用：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Entity<span class="token punctuation">,</span> PrimaryGeneratedColumn<span class="token punctuation">,</span> Column<span class="token punctuation">,</span> BaseEntity <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;typeorm&quot;</span><span class="token punctuation">;</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token keyword">extends</span> <span class="token class-name">BaseEntity</span> <span class="token punctuation">{</span>
  @<span class="token function">PrimaryGeneratedColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  firstName<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  lastName<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  age<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>逻辑操作如下所示:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
user<span class="token punctuation">.</span>firstName <span class="token operator">=</span> <span class="token string">&quot;Timber&quot;</span><span class="token punctuation">;</span>
user<span class="token punctuation">.</span>lastName <span class="token operator">=</span> <span class="token string">&quot;Saw&quot;</span><span class="token punctuation">;</span>
user<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">25</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> user<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> allUsers <span class="token operator">=</span> <span class="token keyword">await</span> User<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> firstUser <span class="token operator">=</span> <span class="token keyword">await</span> User<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> timber <span class="token operator">=</span> <span class="token keyword">await</span> User<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span> firstName<span class="token punctuation">:</span> <span class="token string">&quot;Timber&quot;</span><span class="token punctuation">,</span> lastName<span class="token punctuation">:</span> <span class="token string">&quot;Saw&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">await</span> timber<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h1 id="入门"><a href="#入门" class="header-anchor">#</a> 入门</h1> <h2 id="安装"><a href="#安装" class="header-anchor">#</a> 安装</h2> <ol><li><p>通过<code>npm</code>安装:</p> <p><code>npm install typeorm --save</code></p></li> <li><p>你还需要安装 <code>reflect-metadata</code>:</p> <p><code>npm install reflect-metadata --save</code></p> <p>并且需要在应用程序的全局位置导入（例如在<code>app.ts</code>中）</p> <p><code>import &quot;reflect-metadata&quot;;</code></p></li> <li><p>你可能还需要安装 node typings(以此来使用 Node 的智能提示):</p> <p><code>npm install @types/node --save</code></p></li> <li><p>安装数据库驱动:</p> <ul><li><p><strong>MySQL</strong> 或者 <strong>MariaDB</strong></p> <p><code>npm install mysql --save</code> (也可以安装 <code>mysql2</code>)</p></li> <li><p><strong>PostgreSQL</strong></p> <p><code>npm install pg --save</code></p></li> <li><p><strong>SQLite</strong></p> <p><code>npm install sqlite3 --save</code></p></li> <li><p><strong>Microsoft SQL Server</strong></p> <p><code>npm install mssql --save</code></p></li> <li><p><strong>sql.js</strong></p> <p><code>npm install sql.js --save</code></p></li> <li><p><strong>Oracle</strong></p> <p><code>npm install oracledb --save</code></p> <p>根据你使用的数据库，仅安装其中<em>一个</em>即可。
要使 Oracle 驱动程序正常工作，需要按照其<a href="https://github.com/oracle/node-oracledb" target="_blank" rel="noopener noreferrer">站点<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>中的安装说明进行操作。</p></li> <li><p><strong>MongoDB</strong> (试验性)</p> <p><code>npm install mongodb --save</code></p></li> <li><p><strong>NativeScript</strong>, <strong>react-native</strong> 和 <strong>Cordova</strong></p> <p>查看 <a href="/vuepressblog/supported-platforms.html">支持的平台</a></p></li></ul></li></ol> <h5 id="typescript-配置"><a href="#typescript-配置" class="header-anchor">#</a> TypeScript 配置</h5> <p>此外，请确保你使用的是 TypeScript 编译器版本<strong>2.3</strong>或更高版本，并且已经在<code>tsconfig.json</code>中启用了以下设置:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;emitDecoratorMetadata&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token property">&quot;experimentalDecorators&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
</code></pre></div><p>你可能还需要在编译器选项的<code>lib</code>中启用<code>es6</code>，或者从<code>@types</code>安装<code>es6-shim</code>。</p> <h2 id="快速开始"><a href="#快速开始" class="header-anchor">#</a> 快速开始</h2> <p>开始使用 TypeORM 的最快方法是使用其 CLI 命令生成启动项目。
只有在 NodeJS 应用程序中使用 TypeORM 时，此操作才有效。如果你使用的是其他平台，请继续执行<a href="#%E5%88%86%E6%AD%A5%E6%8C%87%E5%8D%97">分步指南</a>。</p> <p>首先全局安装 TypeORM:</p> <div class="language- extra-class"><pre class="language-text"><code>npm install typeorm -g
</code></pre></div><p>然后转到要创建新项目的目录并运行命令：</p> <div class="language- extra-class"><pre class="language-text"><code>typeorm init --name MyProject --database mysql
</code></pre></div><p>其中<code>name</code>是项目的名称，<code>database</code>是您将使用的数据库。</p> <p>数据库可以是以下值之一: <code>mysql</code>, <code>mariadb</code>, <code>postgres</code>, <code>sqlite</code>, <code>mssql</code>, <code>oracle</code>, <code>mongodb</code>,
<code>cordova</code>, <code>react-native</code>, <code>expo</code>, <code>nativescript</code>.</p> <p>此命令将在<code>MyProject</code>目录中生成一个包含以下文件的新项目:</p> <div class="language- extra-class"><pre class="language-text"><code>MyProject
├── src              // TypeScript 代码
│   ├── entity       // 存储实体（数据库模型）的位置
│   │   └── User.ts  // 示例 entity
│   ├── migration    // 存储迁移的目录
│   └── index.ts     // 程序执行主文件
├── .gitignore       // gitignore文件
├── ormconfig.json   // ORM和数据库连接配置
├── package.json     // node module 依赖
├── README.md        // 简单的 readme 文件
└── tsconfig.json    // TypeScript 编译选项
</code></pre></div><blockquote><p>你还可以在现有 node 项目上运行<code>typeorm init</code>，但要注意，此操作可能会覆盖已有的某些文件。</p></blockquote> <p>接下来安装项目依赖项：</p> <div class="language- extra-class"><pre class="language-text"><code>cd MyProject
npm install
</code></pre></div><p>在安装过程中，编辑<code>ormconfig.json</code>文件并在其中放置您自己的数据库连接配置选项：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mysql&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;host&quot;</span><span class="token operator">:</span> <span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;port&quot;</span><span class="token operator">:</span> <span class="token number">3306</span><span class="token punctuation">,</span>
  <span class="token property">&quot;username&quot;</span><span class="token operator">:</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;password&quot;</span><span class="token operator">:</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;database&quot;</span><span class="token operator">:</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;synchronize&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token property">&quot;logging&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;entities&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;src/entity/**/*.ts&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;migrations&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;src/migration/**/*.ts&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;subscribers&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;src/subscriber/**/*.ts&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>绝大多数情况下，你只需要配置
<code>host</code>, <code>username</code>, <code>password</code>, <code>database</code> 或者 <code>port</code>。</p> <p>完成配置并安装所有 node modules 后，即可运行应用程序：</p> <div class="language- extra-class"><pre class="language-text"><code>npm start
</code></pre></div><p>至此你的应用程序应该成功运行并将新用户插入数据库。你可以继续使用此项目并集成所需的其他模块并创建更多实体。</p> <blockquote><p>你可以通过运行<code>typeorm init --name MyProject --database mysql --express</code>来生成一个更高级的 Express 项目</p></blockquote> <h2 id="分步指南"><a href="#分步指南" class="header-anchor">#</a> 分步指南</h2> <p>您对 ORM 有何期待？您期望它将为您创建数据库表，并且无需编写大量难以维护的 SQL 语句来查找/插入/更新/删除您的数据。本指南将向您展示如何从头开始设置 TypeORM 并实现这些操作。</p> <h3 id="创建一个模型"><a href="#创建一个模型" class="header-anchor">#</a> 创建一个模型</h3> <p>使用数据库从创建表开始。如何告诉 TypeORM 创建数据库表？答案是 - 通过模型。
应用程序中的模型即是数据库中的表。</p> <p>举个例子, 你有一个<code>Photo</code> 模型:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Photo</span> <span class="token punctuation">{</span>
  id<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  name<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  description<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  filename<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  views<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>并且希望将 photos 存储在数据库中。要在数据库中存储内容，首先需要一个数据库表，并从模型中创建数据库表。但是并非所有模型，只有您定义为<em>entities</em>的模型。</p> <h3 id="创建一个实体"><a href="#创建一个实体" class="header-anchor">#</a> 创建一个实体</h3> <p><em>Entity</em>是由<code>@Entity</code>装饰器装饰的模型。将为此类模型创建数据库表。你可以使用 TypeORM 处理各处的实体，可以使用它们 load/insert/update/remove 并执行其他操作。</p> <p>让我们将<code>Photo</code>模型作为一个实体</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Entity <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;typeorm&quot;</span><span class="token punctuation">;</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Photo</span> <span class="token punctuation">{</span>
  id<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  name<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  description<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  filename<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  views<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  isPublished<span class="token punctuation">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>现在，将为<code>Photo</code>实体创建一个数据库表，我们将能够在应用程序中的任何位置使用它。
我们已经创建了一个数据库表，但是没有哪个字段属于哪一列，下面让我们在数据库表中创建几列。</p> <h3 id="添加表列"><a href="#添加表列" class="header-anchor">#</a> 添加表列</h3> <p>要添加数据库列，你只需要将要生成的实体属性加上<code>@Column</code>装饰器。</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Entity<span class="token punctuation">,</span> Column <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;typeorm&quot;</span><span class="token punctuation">;</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Photo</span> <span class="token punctuation">{</span>
  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  name<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  description<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  filename<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  views<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  isPublished<span class="token punctuation">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>现在 <code>id</code>, <code>name</code>, <code>description</code>, <code>filename</code>, <code>views</code> 和 <code>isPublished</code> 列将会被添加到<code>photo</code>表中。
数据库中的列类型是根据你使用的属性类型推断的，例如： <code>number</code>将被转换为<code>integer</code>，<code>string</code>将转换为<code>varchar</code>，<code>boolean</code>转换为<code>bool</code>等。但你也可以通过在<code>@Column</code>装饰器中隐式指定列类型来使用数据库支持的任何列类型。</p> <p>我们已经生成了一个包含列的数据库表，但还剩下一件事。每个数据库表必须具有包含主键的列。</p> <h3 id="创建主列"><a href="#创建主列" class="header-anchor">#</a> 创建主列</h3> <p>每个实体<strong>必须</strong>至少有一个主键列。这是必须的，你无法避免。要使列成为主键，您需要使用<code>@PrimaryColumn</code>装饰器。</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Entity<span class="token punctuation">,</span> Column<span class="token punctuation">,</span> PrimaryColumn <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;typeorm&quot;</span><span class="token punctuation">;</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Photo</span> <span class="token punctuation">{</span>
  @<span class="token function">PrimaryColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  name<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  description<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  filename<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  views<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  isPublished<span class="token punctuation">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="创建自动生成的列"><a href="#创建自动生成的列" class="header-anchor">#</a> 创建自动生成的列</h3> <p>假设你希望 id 列自动生成（这称为 auto-increment/sequence/serial/generated identity column）。为此你需要将<code>@PrimaryColumn</code>装饰器更改为<code>@PrimaryGeneratedColumn</code>装饰器：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Entity<span class="token punctuation">,</span> Column<span class="token punctuation">,</span> PrimaryGeneratedColumn <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;typeorm&quot;</span><span class="token punctuation">;</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Photo</span> <span class="token punctuation">{</span>
  @<span class="token function">PrimaryGeneratedColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  name<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  description<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  filename<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  views<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  isPublished<span class="token punctuation">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="列数据类型"><a href="#列数据类型" class="header-anchor">#</a> 列数据类型</h3> <p>接下来，让我们修复数据类型。默认情况下，字符串被映射到一个 varchar(255)类型（取决于数据库类型）。
数字被映射到一个类似整数类型（取决于数据库类型）。但是我们不希望所有的列都是有限的 varchars 或整数，让我们修改下代码以设置想要的数据类型：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Entity<span class="token punctuation">,</span> Column<span class="token punctuation">,</span> PrimaryGeneratedColumn <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;typeorm&quot;</span><span class="token punctuation">;</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Photo</span> <span class="token punctuation">{</span>
  @<span class="token function">PrimaryGeneratedColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    length<span class="token punctuation">:</span> <span class="token number">100</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  name<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token string">&quot;text&quot;</span><span class="token punctuation">)</span>
  description<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  filename<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token string">&quot;double&quot;</span><span class="token punctuation">)</span>
  views<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  isPublished<span class="token punctuation">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>列类型是特定于数据库的。你可以设置数据库支持的任何列类型。有关支持的列类型的更多信息，请参见<a href="/vuepressblog/_posts/typeromdoc/docs/entities.html#column-types">此处</a>。</p> <h3 id="创建数据库的连接"><a href="#创建数据库的连接" class="header-anchor">#</a> 创建数据库的连接</h3> <p>当实体被创建后，让我们创建一个<code>index.ts</code>（或<code>app.ts</code>，无论你怎么命名）文件，并配置数据库连接：:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token string">&quot;reflect-metadata&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createConnection <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;typeorm&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Photo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./entity/Photo&quot;</span><span class="token punctuation">;</span>

<span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token keyword">type</span><span class="token punctuation">:</span> <span class="token string">&quot;mysql&quot;</span><span class="token punctuation">,</span>
  host<span class="token punctuation">:</span> <span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span>
  port<span class="token punctuation">:</span> <span class="token number">3306</span><span class="token punctuation">,</span>
  username<span class="token punctuation">:</span> <span class="token string">&quot;root&quot;</span><span class="token punctuation">,</span>
  password<span class="token punctuation">:</span> <span class="token string">&quot;admin&quot;</span><span class="token punctuation">,</span>
  database<span class="token punctuation">:</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">,</span>
  entities<span class="token punctuation">:</span> <span class="token punctuation">[</span>Photo<span class="token punctuation">]</span><span class="token punctuation">,</span>
  synchronize<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  logging<span class="token punctuation">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">connection</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 这里可以写实体操作相关的代码</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>我们在此示例中使用 MySQL，你可以使用任何其他受支持的数据库。要使用其他数据库，只需将选项中的<code>type</code>更改为希望使用的数据库类型：mysql，mariadb，postgres，sqlite，mssql，oracle，cordova，nativescript，react-native，expo 或 mongodb。同时还要确保 host, port, username, password 和数据库设置的正确性。</p> <p>我们将 Photo 实体添加到此连接的实体列表中。所有需要在连接中使用的每个实体都必须加到这个表中。</p> <p>设置<code>synchronize</code>可确保每次运行应用程序时实体都将与数据库同步。</p> <h3 id="加载目录中所有实体"><a href="#加载目录中所有实体" class="header-anchor">#</a> 加载目录中所有实体</h3> <p>之后当我们创建更多实体时，都需要将一一它们添加到配置中的实体中，但是这不是很方便，所以我们可以设置整个目录，从中连接所有实体并在连接中使用：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createConnection <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;typeorm&quot;</span><span class="token punctuation">;</span>

<span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token keyword">type</span><span class="token punctuation">:</span> <span class="token string">&quot;mysql&quot;</span><span class="token punctuation">,</span>
  host<span class="token punctuation">:</span> <span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span>
  port<span class="token punctuation">:</span> <span class="token number">3306</span><span class="token punctuation">,</span>
  username<span class="token punctuation">:</span> <span class="token string">&quot;root&quot;</span><span class="token punctuation">,</span>
  password<span class="token punctuation">:</span> <span class="token string">&quot;admin&quot;</span><span class="token punctuation">,</span>
  database<span class="token punctuation">:</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">,</span>
  entities<span class="token punctuation">:</span> <span class="token punctuation">[</span>__dirname <span class="token operator">+</span> <span class="token string">&quot;/entity/*.js&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  synchronize<span class="token punctuation">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">connection</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 这里可以写实体操作相关的代码</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>但要小心这种方法。
如果使用的是<code>ts-node</code>，则需要指定<code>.ts</code>文件的路径。
如果使用的是<code>outDir</code>，那么需要在<code>outDir</code>目录中指定<code>.js</code>文件的路径。
如果使用<code>outDir</code>，当你删除或重命名实体时，请确保清除<code>outDir</code>目录并再次重新编译项目，因为当你删除<code>.ts</code>源文件时，其编译的<code>.js</code>版本不会从输出目录中删除,并且 TypeORM 依然会从<code>outDir</code>中加载这些文件，从而导致异常。</p> <h3 id="启动应用"><a href="#启动应用" class="header-anchor">#</a> 启动应用</h3> <p>现在可以启动<code>app.ts</code>，启动后可以发现数据库自动被初始化，并且 Photo 这个表也会创建出来。</p> <div class="language-bash extra-class"><pre class="language-bash"><code>+-------------+--------------+----------------------------+
<span class="token operator">|</span>                         photo                           <span class="token operator">|</span>
+-------------+--------------+----------------------------+
<span class="token operator">|</span> <span class="token function">id</span>          <span class="token operator">|</span> int<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>      <span class="token operator">|</span> PRIMARY KEY AUTO_INCREMENT <span class="token operator">|</span>
<span class="token operator">|</span> name        <span class="token operator">|</span> varchar<span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span> <span class="token operator">|</span>                            <span class="token operator">|</span>
<span class="token operator">|</span> description <span class="token operator">|</span> text         <span class="token operator">|</span>                            <span class="token operator">|</span>
<span class="token operator">|</span> filename    <span class="token operator">|</span> varchar<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">|</span>                            <span class="token operator">|</span>
<span class="token operator">|</span> views       <span class="token operator">|</span> int<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>      <span class="token operator">|</span>                            <span class="token operator">|</span>
<span class="token operator">|</span> isPublished <span class="token operator">|</span> boolean      <span class="token operator">|</span>                            <span class="token operator">|</span>
+-------------+--------------+----------------------------+
</code></pre></div><h3 id="添加和插入-photo"><a href="#添加和插入-photo" class="header-anchor">#</a> 添加和插入 photo</h3> <p>现在创建一个新的 photo 存到数据库：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createConnection <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;typeorm&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Photo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./entity/Photo&quot;</span><span class="token punctuation">;</span>

<span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token comment">/*...*/</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">connection</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> photo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Photo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    photo<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;Me and Bears&quot;</span><span class="token punctuation">;</span>
    photo<span class="token punctuation">.</span>description <span class="token operator">=</span> <span class="token string">&quot;I am near polar bears&quot;</span><span class="token punctuation">;</span>
    photo<span class="token punctuation">.</span>filename <span class="token operator">=</span> <span class="token string">&quot;photo-with-bears.jpg&quot;</span><span class="token punctuation">;</span>
    photo<span class="token punctuation">.</span>views <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    photo<span class="token punctuation">.</span>isPublished <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> connection<span class="token punctuation">.</span>manager<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>photo<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">photo</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Photo has been saved. Photo id is&quot;</span><span class="token punctuation">,</span> photo<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>保存实体后，它将获得新生成的 ID。 <code>save</code>方法返回传递给它的同一对象的实例。但它不是对象的新副本，只是修改了它的&quot;id&quot;并返回它。</p> <h3 id="使用-async-await-语法"><a href="#使用-async-await-语法" class="header-anchor">#</a> 使用 async/await 语法</h3> <p>我们可以使用最新的 ES8（ES2017）功能，并使用 async / await 语法代替：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createConnection <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;typeorm&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Photo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./entity/Photo&quot;</span><span class="token punctuation">;</span>

<span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token comment">/*...*/</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token parameter">connection</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> photo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Photo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    photo<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;Me and Bears&quot;</span><span class="token punctuation">;</span>
    photo<span class="token punctuation">.</span>description <span class="token operator">=</span> <span class="token string">&quot;I am near polar bears&quot;</span><span class="token punctuation">;</span>
    photo<span class="token punctuation">.</span>filename <span class="token operator">=</span> <span class="token string">&quot;photo-with-bears.jpg&quot;</span><span class="token punctuation">;</span>
    photo<span class="token punctuation">.</span>views <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    photo<span class="token punctuation">.</span>isPublished <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

    <span class="token keyword">await</span> connection<span class="token punctuation">.</span>manager<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>photo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Photo has been saved&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="使用-entity-manager"><a href="#使用-entity-manager" class="header-anchor">#</a> 使用 Entity Manager</h3> <p>我们刚创建了一张新 photo 并将其保存在数据库中。使用<code>EntityManager</code>你可以操纵应用中的任何实体。</p> <p>例如，加载已经保存的实体：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createConnection <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;typeorm&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Photo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./entity/Photo&quot;</span><span class="token punctuation">;</span>

<span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token comment">/*...*/</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token parameter">connection</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">/*...*/</span>
    <span class="token keyword">let</span> savedPhotos <span class="token operator">=</span> <span class="token keyword">await</span> connection<span class="token punctuation">.</span>manager<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>Photo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;All photos from the db: &quot;</span><span class="token punctuation">,</span> savedPhotos<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>savedPhotos</code>是一个 Photo 对象数组，其中包含从数据库加载的数据。</p> <p>了解<a href="/vuepressblog/_posts/typeromdoc/docs/working-with-entity-manager.html">更多</a>有关 EntityManager 的信息。</p> <h3 id="使用-repositories"><a href="#使用-repositories" class="header-anchor">#</a> 使用 Repositories</h3> <p>现在让我们重构之前的代码，并使用<code>Repository</code>而不是<code>EntityManager</code>。每个实体都有自己的存储库，可以处理其实体的所有操作。当你经常处理实体时，Repositories 比 EntityManagers 更方便使用：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createConnection <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;typeorm&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Photo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./entity/Photo&quot;</span><span class="token punctuation">;</span>

<span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token comment">/*...*/</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token parameter">connection</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> photo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Photo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    photo<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;Me and Bears&quot;</span><span class="token punctuation">;</span>
    photo<span class="token punctuation">.</span>description <span class="token operator">=</span> <span class="token string">&quot;I am near polar bears&quot;</span><span class="token punctuation">;</span>
    photo<span class="token punctuation">.</span>filename <span class="token operator">=</span> <span class="token string">&quot;photo-with-bears.jpg&quot;</span><span class="token punctuation">;</span>
    photo<span class="token punctuation">.</span>views <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    photo<span class="token punctuation">.</span>isPublished <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> photoRepository <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">getRepository</span><span class="token punctuation">(</span>Photo<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">await</span> photoRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>photo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Photo has been saved&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> savedPhotos <span class="token operator">=</span> <span class="token keyword">await</span> photoRepository<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;All photos from the db: &quot;</span><span class="token punctuation">,</span> savedPhotos<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>了解<a href="/vuepressblog/_posts/typeromdoc/docs/working-with-repository.html">更多</a>有关 Repository 的信息。</p> <h3 id="从数据库加载"><a href="#从数据库加载" class="header-anchor">#</a> 从数据库加载</h3> <p>让我们使用 Repository 尝试更多的加载操作:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createConnection <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;typeorm&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Photo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./entity/Photo&quot;</span><span class="token punctuation">;</span>

<span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token comment">/*...*/</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token parameter">connection</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">/*...*/</span>
    <span class="token keyword">let</span> allPhotos <span class="token operator">=</span> <span class="token keyword">await</span> photoRepository<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;All photos from the db: &quot;</span><span class="token punctuation">,</span> allPhotos<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> firstPhoto <span class="token operator">=</span> <span class="token keyword">await</span> photoRepository<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;First photo from the db: &quot;</span><span class="token punctuation">,</span> firstPhoto<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> meAndBearsPhoto <span class="token operator">=</span> <span class="token keyword">await</span> photoRepository<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">&quot;Me and Bears&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Me and Bears photo from the db: &quot;</span><span class="token punctuation">,</span> meAndBearsPhoto<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> allViewedPhotos <span class="token operator">=</span> <span class="token keyword">await</span> photoRepository<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span> views<span class="token punctuation">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;All viewed photos: &quot;</span><span class="token punctuation">,</span> allViewedPhotos<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> allPublishedPhotos <span class="token operator">=</span> <span class="token keyword">await</span> photoRepository<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span> isPublished<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;All published photos: &quot;</span><span class="token punctuation">,</span> allPublishedPhotos<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token punctuation">[</span>allPhotos<span class="token punctuation">,</span> photosCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">await</span> photoRepository<span class="token punctuation">.</span><span class="token function">findAndCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;All photos: &quot;</span><span class="token punctuation">,</span> allPhotos<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Photos count: &quot;</span><span class="token punctuation">,</span> photosCount<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="在数据库中更新"><a href="#在数据库中更新" class="header-anchor">#</a> 在数据库中更新</h3> <p>让我们从数据库加载出 photo，更新并保存到数据库：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createConnection <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;typeorm&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Photo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./entity/Photo&quot;</span><span class="token punctuation">;</span>

<span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token comment">/*...*/</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token parameter">connection</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">/*...*/</span>
    <span class="token keyword">let</span> photoToUpdate <span class="token operator">=</span> <span class="token keyword">await</span> photoRepository<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    photoToUpdate<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;Me, my friends and polar bears&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> photoRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>photoToUpdate<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这个<code>id = 1</code>的 photo 在数据库中就成功更新了。</p> <h3 id="从数据库中删除"><a href="#从数据库中删除" class="header-anchor">#</a> 从数据库中删除</h3> <p>让我们从数据库中删除我们的 Photo:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createConnection <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;typeorm&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Photo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./entity/Photo&quot;</span><span class="token punctuation">;</span>

<span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token comment">/*...*/</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token parameter">connection</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">/*...*/</span>
    <span class="token keyword">let</span> photoToRemove <span class="token operator">=</span> <span class="token keyword">await</span> photoRepository<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> photoRepository<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>photoToRemove<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这个<code>id = 1</code>的 photo 在数据库中被移除了。</p> <h3 id="创建一对一的关系"><a href="#创建一对一的关系" class="header-anchor">#</a> 创建一对一的关系</h3> <p>让我们与另一个类创建一对一的关系。先在<code>PhotoMetadata.ts</code>中创建一个新类。此 PhotoMetadata 类应包含 photo 的其他元信息：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Entity<span class="token punctuation">,</span> Column<span class="token punctuation">,</span> PrimaryGeneratedColumn<span class="token punctuation">,</span> OneToOne<span class="token punctuation">,</span> JoinColumn <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;typeorm&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Photo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./Photo&quot;</span><span class="token punctuation">;</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">PhotoMetadata</span> <span class="token punctuation">{</span>
  @<span class="token function">PrimaryGeneratedColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token string">&quot;int&quot;</span><span class="token punctuation">)</span>
  height<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token string">&quot;int&quot;</span><span class="token punctuation">)</span>
  width<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  orientation<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  compressed<span class="token punctuation">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  comment<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  @<span class="token function">OneToOne</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">type</span></span> <span class="token operator">=&gt;</span> Photo<span class="token punctuation">)</span>
  @<span class="token function">JoinColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  photo<span class="token punctuation">:</span> Photo<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这里我们使用了一个名为<code>@OneToOne</code>的新装饰器,它允许我们在两个实体之间创建一对一的关系。
<code>type =&gt; Photo</code>是一个函数，返回我们想要与之建立关系的实体的类。由于特定于语言的关系，我们只能使用一个返回类的函数，而不是直接使用该类。
同时也可以把它写成<code>()=&gt; Photo</code>，但是<code>type =&gt; Photo</code>显得代码更有可读性。type 变量本身不包含任何内容。</p> <p>我们还添加了一个<code>@JoinColumn</code>装饰器，表明实体键的对应关系。关系可以是单向的或双向的。但是只有一方是拥有者。在关系的所有者方面需要使用@JoinColumn 装饰器。</p> <p>如果运行该应用程序，你将看到一个新生成的表，它将包含一个带有关系外键的列：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>+-------------+--------------+----------------------------+
<span class="token operator">|</span>                     photo_metadata                      <span class="token operator">|</span>
+-------------+--------------+----------------------------+
<span class="token operator">|</span> <span class="token function">id</span>          <span class="token operator">|</span> int<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>      <span class="token operator">|</span> PRIMARY KEY AUTO_INCREMENT <span class="token operator">|</span>
<span class="token operator">|</span> height      <span class="token operator">|</span> int<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>      <span class="token operator">|</span>                            <span class="token operator">|</span>
<span class="token operator">|</span> width       <span class="token operator">|</span> int<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>      <span class="token operator">|</span>                            <span class="token operator">|</span>
<span class="token operator">|</span> comment     <span class="token operator">|</span> varchar<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">|</span>                            <span class="token operator">|</span>
<span class="token operator">|</span> compressed  <span class="token operator">|</span> boolean      <span class="token operator">|</span>                            <span class="token operator">|</span>
<span class="token operator">|</span> orientation <span class="token operator">|</span> varchar<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">|</span>                            <span class="token operator">|</span>
<span class="token operator">|</span> photoId     <span class="token operator">|</span> int<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>      <span class="token operator">|</span> FOREIGN KEY                <span class="token operator">|</span>
+-------------+--------------+----------------------------+
</code></pre></div><h3 id="保存一对一的关系"><a href="#保存一对一的关系" class="header-anchor">#</a> 保存一对一的关系</h3> <p>现在来创建一个 photo，它的元信息将它们互相连接起来。</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createConnection <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;typeorm&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Photo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./entity/Photo&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> PhotoMetadata <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./entity/PhotoMetadata&quot;</span><span class="token punctuation">;</span>

<span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token comment">/*...*/</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token parameter">connection</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 创建 photo</span>
    <span class="token keyword">let</span> photo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Photo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    photo<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;Me and Bears&quot;</span><span class="token punctuation">;</span>
    photo<span class="token punctuation">.</span>description <span class="token operator">=</span> <span class="token string">&quot;I am near polar bears&quot;</span><span class="token punctuation">;</span>
    photo<span class="token punctuation">.</span>filename <span class="token operator">=</span> <span class="token string">&quot;photo-with-bears.jpg&quot;</span><span class="token punctuation">;</span>
    photo<span class="token punctuation">.</span>isPublished <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

    <span class="token comment">// 创建 photo metadata</span>
    <span class="token keyword">let</span> metadata <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PhotoMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    metadata<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">640</span><span class="token punctuation">;</span>
    metadata<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">480</span><span class="token punctuation">;</span>
    metadata<span class="token punctuation">.</span>compressed <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    metadata<span class="token punctuation">.</span>comment <span class="token operator">=</span> <span class="token string">&quot;cybershoot&quot;</span><span class="token punctuation">;</span>
    metadata<span class="token punctuation">.</span>orientation <span class="token operator">=</span> <span class="token string">&quot;portait&quot;</span><span class="token punctuation">;</span>
    metadata<span class="token punctuation">.</span>photo <span class="token operator">=</span> photo<span class="token punctuation">;</span> <span class="token comment">// 联接两者</span>

    <span class="token comment">// 获取实体 repositories</span>
    <span class="token keyword">let</span> photoRepository <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">getRepository</span><span class="token punctuation">(</span>Photo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> metadataRepository <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">getRepository</span><span class="token punctuation">(</span>PhotoMetadata<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 先保存photo</span>
    <span class="token keyword">await</span> photoRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>photo<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 然后保存photo的metadata</span>
    <span class="token keyword">await</span> metadataRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>metadata<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 完成</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Metadata is saved, and relation between metadata and photo is created in the database too&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="反向关系"><a href="#反向关系" class="header-anchor">#</a> 反向关系</h3> <p>关系可以是单向的或双向的。目前 PhotoMetadata 和 Photo 之间的关系是单向的。关系的所有者是 PhotoMetadata，而 Photo 对 PhotoMetadata 一无所知。这使得从 Photo 中访问 PhotoMetadata 变得很复杂。要解决这个问题，我们应该在 PhotoMetadata 和 Photo 之间建立双向关系。让我们来修改一下实体：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Entity<span class="token punctuation">,</span> Column<span class="token punctuation">,</span> PrimaryGeneratedColumn<span class="token punctuation">,</span> OneToOne<span class="token punctuation">,</span> JoinColumn <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;typeorm&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Photo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./Photo&quot;</span><span class="token punctuation">;</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">PhotoMetadata</span> <span class="token punctuation">{</span>
  <span class="token comment">/* ... other columns */</span>

  @<span class="token function">OneToOne</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">type</span></span> <span class="token operator">=&gt;</span> Photo<span class="token punctuation">,</span> <span class="token parameter">photo</span> <span class="token operator">=&gt;</span> photo<span class="token punctuation">.</span>metadata<span class="token punctuation">)</span>
  @<span class="token function">JoinColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  photo<span class="token punctuation">:</span> Photo<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Entity<span class="token punctuation">,</span> Column<span class="token punctuation">,</span> PrimaryGeneratedColumn<span class="token punctuation">,</span> OneToOne <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;typeorm&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> PhotoMetadata <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./PhotoMetadata&quot;</span><span class="token punctuation">;</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Photo</span> <span class="token punctuation">{</span>
  <span class="token comment">/* ... other columns */</span>

  @<span class="token function">OneToOne</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">type</span></span> <span class="token operator">=&gt;</span> PhotoMetadata<span class="token punctuation">,</span> <span class="token parameter">photoMetadata</span> <span class="token operator">=&gt;</span> photoMetadata<span class="token punctuation">.</span>photo<span class="token punctuation">)</span>
  metadata<span class="token punctuation">:</span> PhotoMetadata<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>photo =&gt; photo.metadata</code>是用来指定反向关系的名称。Photo 类的元数据属性是在 Photo 类中存储 PhotoMetadata 的地方。你可以选择简单地将字符串传递给<code>@OneToOne</code>装饰器，而不是传递返回 photo 属性的函数，例如<code>&quot;metadata&quot;</code>。这种函数类型的方法使我们的重构更容易。</p> <p>注意，我们应该仅在关系的一侧使用<code>@JoinColumn</code>装饰器。你把这个装饰者放在哪一方将是这段关系的拥有方。关系的拥有方包含数据库中具有外键的列。</p> <h3 id="取出关系对象的数据"><a href="#取出关系对象的数据" class="header-anchor">#</a> 取出关系对象的数据</h3> <p>在一个查询中加载 photo 及 photo metadata 有两种方法。使用<code>find *</code>或使用<code>QueryBuilder</code>。我们先使用<code>find *</code>方法。 <code>find *</code>方法允许你使用<code>FindOneOptions</code> / <code>FindManyOptions</code>接口指定对象。</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createConnection <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;typeorm&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Photo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./entity/Photo&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> PhotoMetadata <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./entity/PhotoMetadata&quot;</span><span class="token punctuation">;</span>

<span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token comment">/*...*/</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token parameter">connection</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">/*...*/</span>
    <span class="token keyword">let</span> photoRepository <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">getRepository</span><span class="token punctuation">(</span>Photo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> photos <span class="token operator">=</span> <span class="token keyword">await</span> photoRepository<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span> relations<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;metadata&quot;</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>photos 将包含来自数据库的 photos 数组，每个 photo 将包含其 photo metadata。详细了解本文档中的<a href="/vuepressblog/_posts/typeromdoc/docs/find-options.html">查找选项</a>。</p> <p>使用查找选项很简单，但是如果你需要更复杂的查询，则应该使用<code>QueryBuilder</code>。 <code>QueryBuilder</code>允许以更优雅的方式使用更复杂的查询：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createConnection <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;typeorm&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Photo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./entity/Photo&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> PhotoMetadata <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./entity/PhotoMetadata&quot;</span><span class="token punctuation">;</span>

<span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token comment">/*...*/</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token parameter">connection</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">/*...*/</span>
    <span class="token keyword">let</span> photos <span class="token operator">=</span> <span class="token keyword">await</span> connection
      <span class="token punctuation">.</span><span class="token function">getRepository</span><span class="token punctuation">(</span>Photo<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">createQueryBuilder</span><span class="token punctuation">(</span><span class="token string">&quot;photo&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">innerJoinAndSelect</span><span class="token punctuation">(</span><span class="token string">&quot;photo.metadata&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;metadata&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">getMany</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>QueryBuilder</code>允许创建和执行几乎任何复杂性的 SQL 查询。使用<code>QueryBuilder</code>时，请考虑创建 SQL 查询。在此示例中，&quot;photo&quot;和&quot;metadata&quot;是应用于所选 photos 的 ​​ 别名。你可以使用别名来访问所选数据的列和属性。</p> <h3 id="使用-cascades-自动保存相关对象"><a href="#使用-cascades-自动保存相关对象" class="header-anchor">#</a> 使用 cascades 自动保存相关对象</h3> <p>我们可以在关系中设置<code>cascade</code>选项，这是就可以在保存其他对象的同时保存相关对象。让我们更改一下的 photo 的<code>@OneToOne</code>装饰器：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Photo</span> <span class="token punctuation">{</span>
  <span class="token comment">/// ... other columns</span>

  @<span class="token function">OneToOne</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">type</span></span> <span class="token operator">=&gt;</span> PhotoMetadata<span class="token punctuation">,</span> <span class="token parameter">metadata</span> <span class="token operator">=&gt;</span> metadata<span class="token punctuation">.</span>photo<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    cascade<span class="token punctuation">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  metadata<span class="token punctuation">:</span> PhotoMetadata<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>使用<code>cascade</code>允许就不需要边存 photo 边存元数据对象。我们可以简单地保存一个 photo 对象，由于使用了 cascade，metadata 也将自动保存。</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token function">createConnection</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token parameter">connection</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 创建 photo 对象</span>
    <span class="token keyword">let</span> photo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Photo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    photo<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;Me and Bears&quot;</span><span class="token punctuation">;</span>
    photo<span class="token punctuation">.</span>description <span class="token operator">=</span> <span class="token string">&quot;I am near polar bears&quot;</span><span class="token punctuation">;</span>
    photo<span class="token punctuation">.</span>filename <span class="token operator">=</span> <span class="token string">&quot;photo-with-bears.jpg&quot;</span><span class="token punctuation">;</span>
    photo<span class="token punctuation">.</span>isPublished <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

    <span class="token comment">// 创建 photo metadata 对象</span>
    <span class="token keyword">let</span> metadata <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PhotoMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    metadata<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">640</span><span class="token punctuation">;</span>
    metadata<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">480</span><span class="token punctuation">;</span>
    metadata<span class="token punctuation">.</span>compressed <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    metadata<span class="token punctuation">.</span>comment <span class="token operator">=</span> <span class="token string">&quot;cybershoot&quot;</span><span class="token punctuation">;</span>
    metadata<span class="token punctuation">.</span>orientation <span class="token operator">=</span> <span class="token string">&quot;portait&quot;</span><span class="token punctuation">;</span>

    photo<span class="token punctuation">.</span>metadata <span class="token operator">=</span> metadata<span class="token punctuation">;</span> <span class="token comment">// this way we connect them</span>

    <span class="token comment">// 获取 repository</span>
    <span class="token keyword">let</span> photoRepository <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">getRepository</span><span class="token punctuation">(</span>Photo<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 保存photo的同时保存metadata</span>
    <span class="token keyword">await</span> photoRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>photo<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Photo is saved, photo metadata is saved too.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="创建多对一-一对多关系"><a href="#创建多对一-一对多关系" class="header-anchor">#</a> 创建多对一/一对多关系</h3> <p>让我们创建一个多对一/一对多的关系。假设一个 photo 有一个 author，每个 author 都可以有多个 photos。首先让我们创建一个<code>Author</code>类：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Entity<span class="token punctuation">,</span> Column<span class="token punctuation">,</span> PrimaryGeneratedColumn<span class="token punctuation">,</span> OneToMany<span class="token punctuation">,</span> JoinColumn <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;typeorm&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Photo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./Photo&quot;</span><span class="token punctuation">;</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Author</span> <span class="token punctuation">{</span>
  @<span class="token function">PrimaryGeneratedColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  name<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  @<span class="token function">OneToMany</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">type</span></span> <span class="token operator">=&gt;</span> Photo<span class="token punctuation">,</span> <span class="token parameter">photo</span> <span class="token operator">=&gt;</span> photo<span class="token punctuation">.</span>author<span class="token punctuation">)</span> <span class="token comment">// note: we will create author property in the Photo class below</span>
  photos<span class="token punctuation">:</span> Photo<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>Author</code> 包含反向关系。
<code>OneToMany</code> 总是反向的, 并且总是与 <code>ManyToOne</code>一起出现。</p> <p>现在让我们将关系的所有者方添加到 Photo 实体中：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Entity<span class="token punctuation">,</span> Column<span class="token punctuation">,</span> PrimaryGeneratedColumn<span class="token punctuation">,</span> ManyToOne <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;typeorm&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> PhotoMetadata <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./PhotoMetadata&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Author <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./Author&quot;</span><span class="token punctuation">;</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Photo</span> <span class="token punctuation">{</span>
  <span class="token comment">/* ... other columns */</span>

  @<span class="token function">ManyToOne</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">type</span></span> <span class="token operator">=&gt;</span> Author<span class="token punctuation">,</span> <span class="token parameter">author</span> <span class="token operator">=&gt;</span> author<span class="token punctuation">.</span>photos<span class="token punctuation">)</span>
  author<span class="token punctuation">:</span> Author<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在多对一/一对多的关系中，拥有方总是多对一的。这意味着使用<code>@ManyToOne</code>的类将存储相关对象的 id。
运行应用程序后，ORM 将创建<code>author</code>表：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>+-------------+--------------+----------------------------+
<span class="token operator">|</span>                          author                         <span class="token operator">|</span>
+-------------+--------------+----------------------------+
<span class="token operator">|</span> <span class="token function">id</span>          <span class="token operator">|</span> int<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>      <span class="token operator">|</span> PRIMARY KEY AUTO_INCREMENT <span class="token operator">|</span>
<span class="token operator">|</span> name        <span class="token operator">|</span> varchar<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">|</span>                            <span class="token operator">|</span>
+-------------+--------------+----------------------------+
</code></pre></div><p>它还将修改<code>photo</code>表，添加新的<code>author</code>列并为其创建外键：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>+-------------+--------------+----------------------------+
<span class="token operator">|</span>                         photo                           <span class="token operator">|</span>
+-------------+--------------+----------------------------+
<span class="token operator">|</span> <span class="token function">id</span>          <span class="token operator">|</span> int<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>      <span class="token operator">|</span> PRIMARY KEY AUTO_INCREMENT <span class="token operator">|</span>
<span class="token operator">|</span> name        <span class="token operator">|</span> varchar<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">|</span>                            <span class="token operator">|</span>
<span class="token operator">|</span> description <span class="token operator">|</span> varchar<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">|</span>                            <span class="token operator">|</span>
<span class="token operator">|</span> filename    <span class="token operator">|</span> varchar<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">|</span>                            <span class="token operator">|</span>
<span class="token operator">|</span> isPublished <span class="token operator">|</span> boolean      <span class="token operator">|</span>                            <span class="token operator">|</span>
<span class="token operator">|</span> authorId    <span class="token operator">|</span> int<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>      <span class="token operator">|</span> FOREIGN KEY                <span class="token operator">|</span>
+-------------+--------------+----------------------------+
</code></pre></div><h3 id="创建多对多关系"><a href="#创建多对多关系" class="header-anchor">#</a> 创建多对多关系</h3> <p>假设一个 photo 可以放在多个 albums 中，每个 albums 可以包含多个 photo。让我们创建一个<code>Album</code>类：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Entity<span class="token punctuation">,</span> PrimaryGeneratedColumn<span class="token punctuation">,</span> Column<span class="token punctuation">,</span> ManyToMany<span class="token punctuation">,</span> JoinTable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;typeorm&quot;</span><span class="token punctuation">;</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Album</span> <span class="token punctuation">{</span>
  @<span class="token function">PrimaryGeneratedColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  name<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  @<span class="token function">ManyToMany</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">type</span></span> <span class="token operator">=&gt;</span> Photo<span class="token punctuation">,</span> <span class="token parameter">photo</span> <span class="token operator">=&gt;</span> photo<span class="token punctuation">.</span>albums<span class="token punctuation">)</span>
  @<span class="token function">JoinTable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  photos<span class="token punctuation">:</span> Photo<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>@JoinTable</code>需要指定这是关系的所有者方。</p> <p>现在添加反向关系到<code>Photo</code>类：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Photo</span> <span class="token punctuation">{</span>
  <span class="token comment">/// ... other columns</span>

  @<span class="token function">ManyToMany</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">type</span></span> <span class="token operator">=&gt;</span> Album<span class="token punctuation">,</span> <span class="token parameter">album</span> <span class="token operator">=&gt;</span> album<span class="token punctuation">.</span>photos<span class="token punctuation">)</span>
  albums<span class="token punctuation">:</span> Album<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>运行后，ORM 将创建<strong>album_photos_photo_albums</strong>_联结表。</p> <div class="language-bash extra-class"><pre class="language-bash"><code>+-------------+--------------+----------------------------+
<span class="token operator">|</span>                album_photos_photo_albums                <span class="token operator">|</span>
+-------------+--------------+----------------------------+
<span class="token operator">|</span> album_id    <span class="token operator">|</span> int<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>      <span class="token operator">|</span> PRIMARY KEY FOREIGN KEY    <span class="token operator">|</span>
<span class="token operator">|</span> photo_id    <span class="token operator">|</span> int<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>      <span class="token operator">|</span> PRIMARY KEY FOREIGN KEY    <span class="token operator">|</span>
+-------------+--------------+----------------------------+
</code></pre></div><p>记得在 ORM 中使用 ConnectionOptions 注册<code>Album</code>类：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">const</span> options<span class="token punctuation">:</span> ConnectionOptions <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// ... other options</span>
  entities<span class="token punctuation">:</span> <span class="token punctuation">[</span>Photo<span class="token punctuation">,</span> PhotoMetadata<span class="token punctuation">,</span> Author<span class="token punctuation">,</span> Album<span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>现在让我们将 albums 和 photos 插入我们的数据库:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">let</span> connection <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">createConnection</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// create a few albums</span>
<span class="token keyword">let</span> album1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Album</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
album1<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;Bears&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> connection<span class="token punctuation">.</span>manager<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>album1<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> album2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Album</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
album2<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;Me&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> connection<span class="token punctuation">.</span>manager<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>album2<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// create a few photos</span>
<span class="token keyword">let</span> photo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Photo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
photo<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;Me and Bears&quot;</span><span class="token punctuation">;</span>
photo<span class="token punctuation">.</span>description <span class="token operator">=</span> <span class="token string">&quot;I am near polar bears&quot;</span><span class="token punctuation">;</span>
photo<span class="token punctuation">.</span>filename <span class="token operator">=</span> <span class="token string">&quot;photo-with-bears.jpg&quot;</span><span class="token punctuation">;</span>
photo<span class="token punctuation">.</span>albums <span class="token operator">=</span> <span class="token punctuation">[</span>album1<span class="token punctuation">,</span> album2<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> connection<span class="token punctuation">.</span>manager<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>photo<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// now our photo is saved and albums are attached to it</span>
<span class="token comment">// now lets load them:</span>
<span class="token keyword">const</span> loadedPhoto <span class="token operator">=</span> <span class="token keyword">await</span> connection<span class="token punctuation">.</span><span class="token function">getRepository</span><span class="token punctuation">(</span>Photo<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> relations<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;albums&quot;</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>loadedPhoto</code> 如下所示:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token punctuation">{</span>
    id<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    name<span class="token punctuation">:</span> <span class="token string">&quot;Me and Bears&quot;</span><span class="token punctuation">,</span>
    description<span class="token punctuation">:</span> <span class="token string">&quot;I am near polar bears&quot;</span><span class="token punctuation">,</span>
    filename<span class="token punctuation">:</span> <span class="token string">&quot;photo-with-bears.jpg&quot;</span><span class="token punctuation">,</span>
    albums<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
        id<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        name<span class="token punctuation">:</span> <span class="token string">&quot;Bears&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        id<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        name<span class="token punctuation">:</span> <span class="token string">&quot;Me&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="使用-querybuilder"><a href="#使用-querybuilder" class="header-anchor">#</a> 使用 QueryBuilder</h3> <p>你可以使用 QueryBuilder 构建几乎任何复杂性的 SQL 查询。例如，可以这样做：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">let</span> photos <span class="token operator">=</span> <span class="token keyword">await</span> connection
  <span class="token punctuation">.</span><span class="token function">getRepository</span><span class="token punctuation">(</span>Photo<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">createQueryBuilder</span><span class="token punctuation">(</span><span class="token string">&quot;photo&quot;</span><span class="token punctuation">)</span> <span class="token comment">// first argument is an alias. Alias is what you are selecting - photos. You must specify it.</span>
  <span class="token punctuation">.</span><span class="token function">innerJoinAndSelect</span><span class="token punctuation">(</span><span class="token string">&quot;photo.metadata&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;metadata&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">leftJoinAndSelect</span><span class="token punctuation">(</span><span class="token string">&quot;photo.albums&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;album&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">&quot;photo.isPublished = true&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">andWhere</span><span class="token punctuation">(</span><span class="token string">&quot;(photo.name = :photoName OR photo.name = :bearName)&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">orderBy</span><span class="token punctuation">(</span><span class="token string">&quot;photo.id&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;DESC&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">skip</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setParameters</span><span class="token punctuation">(</span><span class="token punctuation">{</span> photoName<span class="token punctuation">:</span> <span class="token string">&quot;My&quot;</span><span class="token punctuation">,</span> bearName<span class="token punctuation">:</span> <span class="token string">&quot;Mishka&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">getMany</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>此查询选择所有 published 的 name 等于&quot;My&quot;或&quot;Mishka&quot;的 photos。它将从结果中的第 5 个（分页偏移）开始，并且仅选择 10 个结果（分页限制）。得到的结果将按 ID 降序排序。photo 的 albums 将被 left-joined，其元数据将被 inner joined。</p> <p>由于 QueryBuilder 的自由度更高，因此在项目中可能会大量的使用它。
更多关于 QueryBuilder 的信息，<a href="/vuepressblog/_posts/typeromdoc/docs/select-query-builder.html">可查看</a>。</p> <h2 id="示例"><a href="#示例" class="header-anchor">#</a> 示例</h2> <p>查看<a href="https://github.com/typeorm/typeorm/tree/master/sample" target="_blank" rel="noopener noreferrer">示例<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>用法。</p> <p>下面这些 repositories 可以帮助你快速开始：</p> <ul><li><a href="https://github.com/typeorm/typescript-example" target="_blank" rel="noopener noreferrer">Example how to use TypeORM with TypeScript<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/typeorm/javascript-example" target="_blank" rel="noopener noreferrer">Example how to use TypeORM with JavaScript<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/typeorm/babel-example" target="_blank" rel="noopener noreferrer">Example how to use TypeORM with JavaScript and Babel<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/typeorm/browser-example" target="_blank" rel="noopener noreferrer">Example how to use TypeORM with TypeScript and SystemJS in Browser<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/typeorm/typescript-express-example" target="_blank" rel="noopener noreferrer">Example how to use Express and TypeORM<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/typeorm/typescript-koa-example" target="_blank" rel="noopener noreferrer">Example how to use Koa and TypeORM<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/typeorm/mongo-typescript-example" target="_blank" rel="noopener noreferrer">Example how to use TypeORM with MongoDB<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/typeorm/cordova-example" target="_blank" rel="noopener noreferrer">Example how to use TypeORM in a Cordova/PhoneGap app<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/typeorm/ionic-example" target="_blank" rel="noopener noreferrer">Example how to use TypeORM with an Ionic app<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/typeorm/react-native-example" target="_blank" rel="noopener noreferrer">Example how to use TypeORM with React Native<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/typeorm/electron-javascript-example" target="_blank" rel="noopener noreferrer">Example how to use TypeORM with Electron using JavaScript<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/typeorm/electron-typescript-example" target="_blank" rel="noopener noreferrer">Example how to use TypeORM with Electron using TypeScript<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h2 id="扩展"><a href="#扩展" class="header-anchor">#</a> 扩展</h2> <p>这几个扩展可以简化 TypeORM 的使用，并将其与其他模块集成：</p> <ul><li><a href="http://vesper-framework.com" target="_blank" rel="noopener noreferrer">TypeORM + GraphQL framework<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/typeorm/typeorm-typedi-extensions" target="_blank" rel="noopener noreferrer">TypeORM integration<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> with <a href="https://github.com/pleerock/typedi" target="_blank" rel="noopener noreferrer">TypeDI<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/typeorm/typeorm-routing-controllers-extensions" target="_blank" rel="noopener noreferrer">TypeORM integration<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> with <a href="https://github.com/pleerock/routing-controllers" target="_blank" rel="noopener noreferrer">routing-controllers<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>从现有数据库生成模型 - <a href="https://github.com/Kononnable/typeorm-model-generator" target="_blank" rel="noopener noreferrer">typeorm-model-generator<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h2 id="贡献"><a href="#贡献" class="header-anchor">#</a> 贡献</h2> <p>了解如何贡献<a href="https://github.com/typeorm/typeorm/blob/master/CONTRIBUTING.md" target="_blank" rel="noopener noreferrer">这里<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>以及如何设置开发环境[这里](https://github.com/typeorm/typeorm/blob/master/ DEVELOPER.md)。</p> <p>感谢所有贡献者：</p> <p><a href="https://github.com/typeorm/typeorm/graphs/contributors"><img src="https://opencollective.com/typeorm/contributors.svg?width=890&amp;showBtn=false"></a></p> <h2 id="赞助商"><a href="#赞助商" class="header-anchor">#</a> 赞助商</h2> <p>开源既困难又耗时。 如果你想投资 TypeORM 的未来，你可以成为赞助商，让我们的核心团队花更多时间在 TypeORM 的改进和新功能上。<a href="https://opencollective.com/typeorm" target="_blank" rel="noopener noreferrer">成为赞助商<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="https://opencollective.com/typeorm" target="_blank"><img src="https://opencollective.com/typeorm/tiers/sponsor.svg?width=890"></a></p> <h2 id="金牌赞助商"><a href="#金牌赞助商" class="header-anchor">#</a> 金牌赞助商</h2> <p>成为金牌赞助商，并从我们的核心贡献者那里获得高级技术支持。 <a href="https://opencollective.com/typeorm" target="_blank" rel="noopener noreferrer">成为金牌赞助商<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="https://opencollective.com/typeorm" target="_blank"><img src="https://opencollective.com/typeorm/tiers/gold-sponsor.svg?width=890"></a></p></div> <hr> <!----></div> <div class="sticker vuepress-toc"><div class="vuepress-toc-item vuepress-toc-h2 active"><a href="#安装" title="安装">安装</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#快速开始" title="快速开始">快速开始</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#分步指南" title="分步指南">分步指南</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#创建一个模型" title="创建一个模型">创建一个模型</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#创建一个实体" title="创建一个实体">创建一个实体</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#添加表列" title="添加表列">添加表列</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#创建主列" title="创建主列">创建主列</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#创建自动生成的列" title="创建自动生成的列">创建自动生成的列</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#列数据类型" title="列数据类型">列数据类型</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#创建数据库的连接" title="创建数据库的连接">创建数据库的连接</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#加载目录中所有实体" title="加载目录中所有实体">加载目录中所有实体</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#启动应用" title="启动应用">启动应用</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#添加和插入-photo" title="添加和插入 photo">添加和插入 photo</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#使用-async-await-语法" title="使用 async/await 语法">使用 async/await 语法</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#使用-entity-manager" title="使用 Entity Manager">使用 Entity Manager</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#使用-repositories" title="使用 Repositories">使用 Repositories</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#从数据库加载" title="从数据库加载">从数据库加载</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#在数据库中更新" title="在数据库中更新">在数据库中更新</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#从数据库中删除" title="从数据库中删除">从数据库中删除</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#创建一对一的关系" title="创建一对一的关系">创建一对一的关系</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#保存一对一的关系" title="保存一对一的关系">保存一对一的关系</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#反向关系" title="反向关系">反向关系</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#取出关系对象的数据" title="取出关系对象的数据">取出关系对象的数据</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#使用-cascades-自动保存相关对象" title="使用 cascades 自动保存相关对象">使用 cascades 自动保存相关对象</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#创建多对一-一对多关系" title="创建多对一/一对多关系">创建多对一/一对多关系</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#创建多对多关系" title="创建多对多关系">创建多对多关系</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#使用-querybuilder" title="使用 QueryBuilder">使用 QueryBuilder</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#示例" title="示例">示例</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#扩展" title="扩展">扩展</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#贡献" title="贡献">贡献</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#赞助商" title="赞助商">赞助商</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#金牌赞助商" title="金牌赞助商">金牌赞助商</a></div></div></div></div> <footer class="footer" data-v-0d113134><div class="footer-left-wrap" data-v-0d113134><ul class="contact" data-v-0d113134><li class="contact-item" data-v-0d113134><a href="https://github.com/ulivz" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-0d113134><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github" data-v-0d113134><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22" data-v-0d113134></path></svg>
          
        </a></li><li class="contact-item" data-v-0d113134><a href="https://twitter.com/_ulivz" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-0d113134><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter" data-v-0d113134><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z" data-v-0d113134></path></svg>
          
        </a></li></ul></div> <div class="footer-right-wrap" data-v-0d113134><ul class="copyright" data-v-0d113134><li class="copyright-item" data-v-0d113134><a href="https://policies.google.com/privacy?hl=en-US" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-0d113134>Privacy Policy</a></li><li class="copyright-item" data-v-0d113134><a href="/vuepressblog/2021/04/20/typeromdoc/.html" class="nav-link" data-v-0d113134>MIT Licensed | Copyright © 2018-present Vue.js</a></li></ul></div></footer></div><div class="global-ui"></div></div>
    <script src="/vuepressblog/assets/js/app.34ed5399.js" defer></script><script src="/vuepressblog/assets/js/4.b4e60a56.js" defer></script><script src="/vuepressblog/assets/js/5.437ceeb3.js" defer></script><script src="/vuepressblog/assets/js/37.1d249a16.js" defer></script>
  </body>
</html>
